flowchart TB
    subgraph top["Foundation"]
        direction LR
        subgraph transport["Transport Security"]
            https[HTTPS/TLS<br/>Encrypted connection]
            hsts[HSTS Header<br/>Force HTTPS]
        end
        
        subgraph auth["Authentication"]
            jwt[JWT Tokens<br/>Signed claims]
            oauth[OAuth 2.0<br/>Delegated auth]
            apikey[API Keys<br/>Simple auth]
        end
    end
    
    subgraph middle["Access Control"]
        direction LR
        subgraph authz["Authorization"]
            rbac[RBAC<br/>Role-based]
            scope[Scopes<br/>Permission sets]
            claims[JWT Claims<br/>Embedded permissions]
        end
        
        subgraph input["Input Security"]
            validate[JSON Schema<br/>Validation]
            sanitize[Sanitization<br/>SQL/XSS prevention]
            ratelimit[Rate Limiting<br/>Abuse prevention]
        end
    end
    
    subgraph bottom["Response"]
        subgraph response["Response Security"]
            cors[CORS<br/>Origin control]
            headers[Security Headers<br/>CSP, X-Frame-Options]
            escape[Output Escaping<br/>XSS prevention]
        end
    end
    
    top --> middle --> bottom
    
    style transport fill:#C8D8E8,stroke:#3a4a5a,color:#2c2c2c
    style auth fill:#D4E8D4,stroke:#3a5a3a,color:#2c2c2c
    style authz fill:#E8D4C0,stroke:#5a4a3a,color:#2c2c2c
    style input fill:#E8C8C8,stroke:#5a4a3a,color:#2c2c2c
    style response fill:#C8D8E8,stroke:#3a4a5a,color:#2c2c2c
