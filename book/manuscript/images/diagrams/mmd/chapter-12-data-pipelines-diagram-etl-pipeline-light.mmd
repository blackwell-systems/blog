graph TB
    subgraph extract["**Extract**"]
        api["**API Calls**<br/>Paginated"]
        checkpoint["**Checkpoint**<br/>Save progress"]
        jsonl["**Write JSON Lines**<br/>Streaming"]
    end
    
    subgraph transform["**Transform**"]
        read["**Read JSON Lines**<br/>Line by line"]
        validate["**Validate**<br/>JSON Schema"]
        map["**Map Fields**<br/>jq or custom"]
        filter["**Filter**<br/>Business rules"]
        quarantine[("**Quarantine**<br/>Invalid data")]
    end
    
    subgraph load["**Load**"]
        batch["**Batch Records**<br/>1000s per batch"]
        insert["**Bulk Insert**<br/>Database"]
        verify["**Verify**<br/>Row counts"]
        retry["**Retry**"]
        complete[["**Complete**"]]
    end
    
    api --> checkpoint --> jsonl
    jsonl --> read --> validate
    validate -->|Valid| map
    validate -->|Invalid| quarantine
    map --> filter --> batch
    batch --> insert --> verify
    verify -->|Success| complete
    verify -->|Failure| retry --> batch
    
    style extract fill:#D4E8D4,stroke:#3a5a3a,color:#2c2c2c
    style transform fill:#C8D8E8,stroke:#3a4a5a,color:#2c2c2c
    style load fill:#E8D4C0,stroke:#5a4a3a,color:#2c2c2c
    style quarantine fill:#E8C8C8,stroke:#5a3a3a,color:#2c2c2c
    style complete fill:#D4E8D4,stroke:#3a5a3a,color:#2c2c2c
