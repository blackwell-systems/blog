flowchart TB
    subgraph sources["Data Sources"]
        api[REST APIs<br/>JSON responses]
        db[(Database<br/>JSON exports)]
        logs[Application Logs<br/>JSON Lines]
        events[Event Stream<br/>Kafka]
    end
    
    subgraph ingestion["Ingestion Layer"]
        extract[Extract<br/>API clients, CDC]
        validate[Validate<br/>JSON Schema]
        buffer[Buffer<br/>Kafka topics]
    end
    
    subgraph processing["Processing Layer"]
        transform[Transform<br/>jq, custom code]
        enrich[Enrich<br/>Lookups, joins]
        aggregate[Aggregate<br/>Windows, rollups]
    end
    
    subgraph storage["Storage Layer"]
        warehouse[(Data Warehouse<br/>BigQuery/Snowflake)]
        oltp[(OLTP Database<br/>PostgreSQL)]
        cache[(Cache<br/>Redis)]
    end
    
    subgraph errors["Error Handling"]
        dlq[Dead Letter Queue<br/>Failed messages]
        quarantine[(Quarantine<br/>Invalid data)]
    end
    
    subgraph monitoring["Monitoring"]
        metrics[Metrics<br/>Prometheus]
        traces[Traces<br/>OpenTelemetry]
        alerts[Alerts<br/>PagerDuty]
    end
    
    sources --> extract
    extract --> validate
    validate -->|Valid| buffer
    validate -->|Invalid| quarantine
    
    buffer --> processing
    processing --> storage
    processing -->|Failed| dlq
    
    storage --> monitoring
    errors --> monitoring
    
    style sources fill:#C8D8E8,stroke:#3a4a5a,color:#2c2c2c
    style ingestion fill:#D4E8D4,stroke:#3a5a3a,color:#2c2c2c
    style processing fill:#E8D4C0,stroke:#5a4a3a,color:#2c2c2c
    style storage fill:#E8C8C8,stroke:#5a3a3a,color:#2c2c2c
    style errors fill:#E8C0C0,stroke:#5a3a3a,color:#2c2c2c
    style monitoring fill:#C8E8D8,stroke:#3a5a4a,color:#2c2c2c
